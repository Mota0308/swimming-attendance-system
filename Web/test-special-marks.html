<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特殊標記功能測試</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e1e5e9;
            border-radius: 5px;
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #5a6fd8;
        }
        .result-area {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🎯 特殊標記功能測試</h1>
        
        <div class="test-section">
            <h3>📝 測試數據處理</h3>
            <p>測試學生數據中的特殊標記識別功能</p>
            <button class="test-button" onclick="testMarkProcessing()">測試標記處理</button>
            <div id="markTestResult" class="result-area"></div>
        </div>
        
        <div class="test-section">
            <h3>👥 測試學生顯示</h3>
            <p>測試帶有特殊標記的學生姓名顯示</p>
            <button class="test-button" onclick="testStudentDisplay()">測試學生顯示</button>
            <div id="studentDisplayResult" class="result-area"></div>
        </div>
        
        <div class="test-section">
            <h3>💾 測試數據保存</h3>
            <p>測試學生數據保存和特殊標記更新</p>
            <button class="test-button" onclick="testDataSaving()">測試數據保存</button>
            <div id="saveTestResult" class="result-area"></div>
        </div>
    </div>

    <script>
        // 測試標記處理功能
        function testMarkProcessing() {
            const testData = [
                {
                    name: '測試學生1',
                    '上課日期': '7月13日🎈, 7月20日, 7月27日',
                    'originalDates': ['7月13日🎈', '7月20日', '7月27日']
                },
                {
                    name: '測試學生2',
                    '上課日期': '7月13日, 7月20日🌟, 7月27日',
                    'originalDates': ['7月13日', '7月20日🌟', '7月27日']
                },
                {
                    name: '測試學生3',
                    '上課日期': '7月13日🎈, 7月20日🌟, 7月27日',
                    'originalDates': ['7月13日🎈', '7月20日🌟', '7月27日']
                }
            ];
            
            // 模擬標記處理
            const processedData = testData.map(student => {
                const hasBalloonMark = checkForSpecialMark(student, '🎈');
                const hasStarMark = checkForSpecialMark(student, '🌟');
                
                return {
                    ...student,
                    hasBalloonMark: hasBalloonMark,
                    hasStarMark: hasStarMark
                };
            });
            
            document.getElementById('markTestResult').innerHTML = `
                <h4>處理結果：</h4>
                <pre>${JSON.stringify(processedData, null, 2)}</pre>
            `;
        }
        
        // 測試學生顯示功能
        function testStudentDisplay() {
            const testStudents = [
                { name: '張小明', hasStarMark: false, hasBalloonMark: false },
                { name: '李小華', hasStarMark: true, hasBalloonMark: false },
                { name: '王小美', hasStarMark: false, hasBalloonMark: true },
                { name: '趙小強', hasStarMark: true, hasBalloonMark: true }
            ];
            
            let displayHTML = '<h4>學生顯示結果：</h4>';
            testStudents.forEach(student => {
                const nameWithMarks = getStudentNameWithMarks(student.name, student.hasStarMark, student.hasBalloonMark);
                displayHTML += `<div style="margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    ${nameWithMarks}
                </div>`;
            });
            
            document.getElementById('studentDisplayResult').innerHTML = displayHTML;
        }
        
        // 測試數據保存功能
        function testDataSaving() {
            const testStudent = {
                name: '測試保存學生',
                '上課日期': '7月13日🎈, 7月20日🌟, 7月27日',
                'originalDates': ['7月13日🎈', '7月20日🌟', '7月27日']
            };
            
            const processedData = processStudentMarks(testStudent);
            
            document.getElementById('saveTestResult').innerHTML = `
                <h4>保存數據結果：</h4>
                <p><strong>原始數據：</strong></p>
                <pre>${JSON.stringify(testStudent, null, 2)}</pre>
                <p><strong>處理後數據：</strong></p>
                <pre>${JSON.stringify(processedData, null, 2)}</pre>
            `;
        }
        
        // 輔助函數
        function checkForSpecialMark(student, mark) {
            const fieldsToCheck = ['上課日期', '上課', '日期', 'time', 'classDates', 'originalDates'];
            
            for (const field of fieldsToCheck) {
                if (student[field]) {
                    const value = String(student[field]);
                    if (value.includes(mark)) {
                        return true;
                    }
                }
            }
            
            if (student.originalDates && Array.isArray(student.originalDates)) {
                for (const date of student.originalDates) {
                    if (String(date).includes(mark)) {
                        return true;
                    }
                }
            }
            
            return false;
        }
        
        function processStudentMarks(studentData) {
            if (!studentData) return studentData;
            
            const hasBalloonMark = checkForSpecialMark(studentData, '🎈');
            const hasStarMark = checkForSpecialMark(studentData, '🌟');
            
            return {
                ...studentData,
                hasBalloonMark: hasBalloonMark,
                hasStarMark: hasStarMark
            };
        }
        
        function getStudentNameWithMarks(studentName, hasStar, hasBalloon) {
            let marks = '';
            
            if (hasStar) {
                marks += `<span class="student-mark star mark-tooltip" data-tooltip="重點學生">🌟</span>`;
            }
            
            if (hasBalloon) {
                marks += `<span class="student-mark balloon mark-tooltip" data-tooltip="氣球標記">🎈</span>`;
            }
            
            if (marks) {
                return `<div class="student-name-with-marks"><span>${studentName}</span>${marks}</div>`;
            } else {
                return studentName;
            }
        }
    </script>
</body>
</html> 
 
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特殊標記功能測試</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e1e5e9;
            border-radius: 5px;
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #5a6fd8;
        }
        .result-area {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🎯 特殊標記功能測試</h1>
        
        <div class="test-section">
            <h3>📝 測試數據處理</h3>
            <p>測試學生數據中的特殊標記識別功能</p>
            <button class="test-button" onclick="testMarkProcessing()">測試標記處理</button>
            <div id="markTestResult" class="result-area"></div>
        </div>
        
        <div class="test-section">
            <h3>👥 測試學生顯示</h3>
            <p>測試帶有特殊標記的學生姓名顯示</p>
            <button class="test-button" onclick="testStudentDisplay()">測試學生顯示</button>
            <div id="studentDisplayResult" class="result-area"></div>
        </div>
        
        <div class="test-section">
            <h3>💾 測試數據保存</h3>
            <p>測試學生數據保存和特殊標記更新</p>
            <button class="test-button" onclick="testDataSaving()">測試數據保存</button>
            <div id="saveTestResult" class="result-area"></div>
        </div>
    </div>

    <script>
        // 測試標記處理功能
        function testMarkProcessing() {
            const testData = [
                {
                    name: '測試學生1',
                    '上課日期': '7月13日🎈, 7月20日, 7月27日',
                    'originalDates': ['7月13日🎈', '7月20日', '7月27日']
                },
                {
                    name: '測試學生2',
                    '上課日期': '7月13日, 7月20日🌟, 7月27日',
                    'originalDates': ['7月13日', '7月20日🌟', '7月27日']
                },
                {
                    name: '測試學生3',
                    '上課日期': '7月13日🎈, 7月20日🌟, 7月27日',
                    'originalDates': ['7月13日🎈', '7月20日🌟', '7月27日']
                }
            ];
            
            // 模擬標記處理
            const processedData = testData.map(student => {
                const hasBalloonMark = checkForSpecialMark(student, '🎈');
                const hasStarMark = checkForSpecialMark(student, '🌟');
                
                return {
                    ...student,
                    hasBalloonMark: hasBalloonMark,
                    hasStarMark: hasStarMark
                };
            });
            
            document.getElementById('markTestResult').innerHTML = `
                <h4>處理結果：</h4>
                <pre>${JSON.stringify(processedData, null, 2)}</pre>
            `;
        }
        
        // 測試學生顯示功能
        function testStudentDisplay() {
            const testStudents = [
                { name: '張小明', hasStarMark: false, hasBalloonMark: false },
                { name: '李小華', hasStarMark: true, hasBalloonMark: false },
                { name: '王小美', hasStarMark: false, hasBalloonMark: true },
                { name: '趙小強', hasStarMark: true, hasBalloonMark: true }
            ];
            
            let displayHTML = '<h4>學生顯示結果：</h4>';
            testStudents.forEach(student => {
                const nameWithMarks = getStudentNameWithMarks(student.name, student.hasStarMark, student.hasBalloonMark);
                displayHTML += `<div style="margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    ${nameWithMarks}
                </div>`;
            });
            
            document.getElementById('studentDisplayResult').innerHTML = displayHTML;
        }
        
        // 測試數據保存功能
        function testDataSaving() {
            const testStudent = {
                name: '測試保存學生',
                '上課日期': '7月13日🎈, 7月20日🌟, 7月27日',
                'originalDates': ['7月13日🎈', '7月20日🌟', '7月27日']
            };
            
            const processedData = processStudentMarks(testStudent);
            
            document.getElementById('saveTestResult').innerHTML = `
                <h4>保存數據結果：</h4>
                <p><strong>原始數據：</strong></p>
                <pre>${JSON.stringify(testStudent, null, 2)}</pre>
                <p><strong>處理後數據：</strong></p>
                <pre>${JSON.stringify(processedData, null, 2)}</pre>
            `;
        }
        
        // 輔助函數
        function checkForSpecialMark(student, mark) {
            const fieldsToCheck = ['上課日期', '上課', '日期', 'time', 'classDates', 'originalDates'];
            
            for (const field of fieldsToCheck) {
                if (student[field]) {
                    const value = String(student[field]);
                    if (value.includes(mark)) {
                        return true;
                    }
                }
            }
            
            if (student.originalDates && Array.isArray(student.originalDates)) {
                for (const date of student.originalDates) {
                    if (String(date).includes(mark)) {
                        return true;
                    }
                }
            }
            
            return false;
        }
        
        function processStudentMarks(studentData) {
            if (!studentData) return studentData;
            
            const hasBalloonMark = checkForSpecialMark(studentData, '🎈');
            const hasStarMark = checkForSpecialMark(studentData, '🌟');
            
            return {
                ...studentData,
                hasBalloonMark: hasBalloonMark,
                hasStarMark: hasStarMark
            };
        }
        
        function getStudentNameWithMarks(studentName, hasStar, hasBalloon) {
            let marks = '';
            
            if (hasStar) {
                marks += `<span class="student-mark star mark-tooltip" data-tooltip="重點學生">🌟</span>`;
            }
            
            if (hasBalloon) {
                marks += `<span class="student-mark balloon mark-tooltip" data-tooltip="氣球標記">🎈</span>`;
            }
            
            if (marks) {
                return `<div class="student-name-with-marks"><span>${studentName}</span>${marks}</div>`;
            } else {
                return studentName;
            }
        }
    </script>
</body>
</html> 