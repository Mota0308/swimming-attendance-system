# 🌐 网页应用端口配置说明

## 📍 端口配置概览

### 当前配置
- **默认端口**: 3000
- **期望端口**: 3001 (与API服务器保持一致)
- **环境变量**: `PORT` (由Railway自动设置)

### 端口优先级
1. **环境变量** `PORT` (最高优先级)
2. **默认值** 3000 (最低优先级)

## 🔍 端口 8080 的来源

端口 8080 可能来自以下原因：

### 1. **Railway 自动分配**
Railway 平台可能自动分配了端口 8080 给网页应用

### 2. **环境变量设置**
检查 Railway 项目设置中的环境变量：
```bash
# 在 Railway Dashboard 中查看
PORT=8080
```

### 3. **端口冲突**
如果端口 3000 或 3001 被占用，系统可能自动选择其他端口

## ✅ 如何修改端口

### 方法1：修改 Railway 环境变量
1. 登录 Railway Dashboard
2. 进入项目设置
3. 在 "Variables" 标签中添加：
   ```
   PORT=3001
   ```

### 方法2：修改代码中的默认端口
编辑 `server.js` 文件：
```javascript
const PORT = process.env.PORT || 3001; // 改为 3001
```

### 方法3：使用 Railway 配置文件
在 `railway.toml` 中添加：
```toml
[deploy.envs]
PORT = "3001"
```

## 🧪 测试端口配置

### 1. 健康检查
访问：`https://your-app.railway.app/health`
查看返回的端口信息

### 2. 端口信息端点
访问：`https://your-app.railway.app/port-info`
查看详细的端口配置信息

### 3. 控制台日志
部署后查看 Railway 日志，会显示：
```
📍 当前端口: 8080
🔧 默认端口: 3000
🎯 期望端口: 3001
⚠️  注意：当前端口 8080 与期望端口 3001 不同
ℹ️  这是由环境变量 PORT=8080 设置的
```

## 🔧 推荐配置

### 生产环境
```bash
PORT=3001  # 与API服务器保持一致
NODE_ENV=production
```

### 开发环境
```bash
PORT=3001  # 本地开发使用
NODE_ENV=development
```

## 📋 部署后检查

1. **等待部署完成** (1-2分钟)
2. **访问健康检查端点** `/health`
3. **查看端口信息** `/port-info`
4. **检查控制台日志** 确认端口配置

## 🚨 常见问题

### Q: 为什么端口不是 3001？
A: Railway 可能自动分配了其他端口，可以通过环境变量 `PORT=3001` 强制设置

### Q: 端口 8080 会影响功能吗？
A: 不会，端口只是访问地址的一部分，功能完全正常

### Q: 如何确保使用端口 3001？
A: 在 Railway 项目设置中添加环境变量 `PORT=3001`

---

**注意**: 端口配置不影响应用功能，但为了保持一致性，建议使用端口 3001 