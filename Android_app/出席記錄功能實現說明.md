# 手機APP管理員版本 - 出席記錄功能實現說明

## 功能概述

在手機APP的管理員版本中，"出席記錄"頁面提供了完整的學生出席記錄搜索和顯示功能，包括：

1. **地點搜索**：下拉清單選擇地點進行搜索
2. **日期搜索**：日曆點擊選擇日期進行搜索
3. **組合搜索**：支持兩個搜索條件同時使用
4. **學生資料表格**：顯示符合搜索條件的所有學生資料

## 搜索機制

### 地點搜索
- **匹配字段**：資料庫中`students`表的`location`字段
- **搜索方式**：下拉清單選擇，包含"全部地點"選項
- **實現邏輯**：精確匹配選定地點的學生記錄

### 日期搜索
- **匹配字段**：資料庫中`students`表的`date`字段（上課日期）
- **搜索方式**：點擊日期選擇器選擇具體日期
- **實現邏輯**：支持多種日期格式匹配
  - 標準格式：`yyyy-MM-dd`
  - 中文格式：`yyyy年MM月dd日`
  - 部分匹配：支持日期內容包含搜索

### 組合搜索
- 支持地點和日期同時搜索
- 邏輯：AND關係，必須同時滿足兩個條件
- 至少需要選擇一個搜索條件

## 表格顯示

### 列欄目對應關係
| 列標題 | 資料庫字段 | 顯示格式 | 說明 |
|--------|------------|----------|------|
| 姓名 | `name` | 純文字 | 學生姓名 |
| 出席 | `option1` | 下拉清單 | 出席狀態選擇 |
| 補/調堂 | `option2` | 下拉清單 | 補堂類型選擇 |
| 補/調堂點數 | `option3` | 輸入框 | 補堂點數 |
| 時間 | `time` | 純文字 | 上課時間段 |

### 出席狀態選項（option1）
- 出席1
- 出席1.5
- 出席2
- 出席2.5
- 出席3
- 缺席

### 補/調堂選項（option2）
- 🌟補0.5堂
- 🌟補1堂
- 🌟補1.5堂
- 🌟補2堂
- 🔁補1堂
- 🔁補1.5堂
- 🔁補2堂
- 🔁補2.5堂
- 🔁補3堂

## 數據分組顯示

### 分組邏輯
1. **按地點分組**：首先按學生上課地點分組
2. **按日期分組**：在每個地點內按上課日期分組
3. **按時間排序**：在每個日期內按上課時間排序

### 顯示格式
- **地點標題**：📍 地點名稱 (共 X 名學生)
- **日期標題**：📅 日期 (共 X 名學生)
- **表格內容**：標準表格格式，包含所有列欄目

## 與電腦版本的一致性

### 顯示格式
- 列標題完全一致
- 下拉選項完全一致
- 數據分組邏輯一致

### 搜索邏輯
- 地點搜索機制一致
- 日期搜索機制一致
- 組合搜索邏輯一致

## 技術實現

### 主要函數
- `setupLocationSpinner()`: 設置地點下拉清單
- `setupDatePicker()`: 設置日期選擇器
- `performAttendanceSearch()`: 執行搜索邏輯
- `filterStudents()`: 過濾學生數據
- `displayAttendanceTable()`: 顯示學生表格
- `createStudentDataRow()`: 創建學生數據行

### 數據處理
- 支持多種日期格式解析
- 智能日期排序（按時間順序）
- 空值處理和默認值設置

## 使用流程

1. **選擇搜索條件**
   - 從地點下拉清單選擇地點（可選）
   - 點擊日期選擇器選擇日期（可選）

2. **執行搜索**
   - 點擊"搜索"按鈕
   - 系統根據條件過濾學生數據

3. **查看結果**
   - 按地點和日期分組顯示
   - 表格形式展示所有符合條件的學生

4. **重置搜索**
   - 點擊"重置"按鈕清空搜索條件
   - 清空表格顯示

## 注意事項

1. **搜索條件**：至少需要選擇一個搜索條件
2. **數據更新**：搜索結果基於預載入的學生數據
3. **格式兼容**：支持多種日期格式的數據
4. **性能優化**：使用緩存數據，避免重複API調用

## 未來改進

1. **實時更新**：支持搜索結果的實時數據更新
2. **高級搜索**：添加更多搜索條件（如學生姓名、課程類型等）
3. **數據導出**：支持搜索結果的數據導出功能
4. **批量操作**：支持對搜索結果的批量編輯操作 